<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üç∏</text></svg>">
    <title>Cocktail Trainer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            overscroll-behavior: none;
        }

        /* Fullscreen mobile layout */
        .trainer-container {
            min-height: 100dvh;
            display: flex;
            flex-direction: column;
        }

        /* Screen transitions */
        .screen {
            display: none;
            flex-direction: column;
            flex: 1;
        }

        .screen.active {
            display: flex;
        }

        /* Progress bar */
        .progress-container {
            background: rgba(14, 165, 233, 0.15);
            border-radius: 9999px;
            overflow: hidden;
            height: 8px;
        }

        .progress-bar {
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            transition: width 0.4s ease-out;
            height: 100%;
            border-radius: 9999px;
        }

        /* Question card */
        .question-card {
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
            border-radius: 1.5rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        /* Answer reveal animation */
        .answer-reveal {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        /* Buttons */
        .btn-primary {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            transition: all 0.2s;
            min-height: 56px;
        }

        .btn-primary:active {
            transform: scale(0.98);
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            transition: all 0.2s;
            min-height: 56px;
        }

        .btn-success:active {
            transform: scale(0.98);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            transition: all 0.2s;
            min-height: 56px;
        }

        .btn-danger:active {
            transform: scale(0.98);
        }

        /* Category/Type buttons */
        .filter-btn {
            transition: all 0.2s;
            min-height: 44px;
        }

        .filter-btn.active {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
        }

        /* Swipe animations */
        .swipe-left {
            transform: translateX(-120%) rotate(-8deg);
            opacity: 0.3;
            transition: all 0.3s ease-out;
        }

        .swipe-right {
            transform: translateX(120%) rotate(8deg);
            opacity: 0.3;
            transition: all 0.3s ease-out;
        }

        /* Stats badges */
        .stat-badge {
            min-width: 60px;
        }

        /* Info button pulse */
        @keyframes pulse-ring {
            0% {
                box-shadow: 0 0 0 0 rgba(14, 165, 233, 0.4);
            }

            70% {
                box-shadow: 0 0 0 8px rgba(14, 165, 233, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(14, 165, 233, 0);
            }
        }

        .info-btn {
            animation: pulse-ring 2s ease-out infinite;
        }

        /* Completion celebration */
        @keyframes celebrate {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        .celebrate-emoji {
            animation: celebrate 0.6s ease-in-out infinite;
        }

        /* Modal */
        .modal-backdrop {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(4px);
        }
    </style>
    <script src="data/loader.js"></script>
</head>

<body class="bg-gray-900 text-gray-200">
    <div class="trainer-container">

        <!-- ============ SETUP SCREEN ============ -->
        <div id="setupScreen" class="screen active p-4">
            <!-- Header -->
            <div class="text-center py-4">
                <a href="index.html"
                    class="inline-flex items-center gap-2 text-sky-400 hover:text-sky-300 mb-3 transition-colors">
                    <span class="text-xl">‚Üê</span>
                    <span class="text-sm font-medium">Home</span>
                </a>
                <h1 class="text-3xl font-bold text-sky-400 mb-1">üç∏ Cocktail Trainer</h1>
                <p class="text-gray-400 text-sm">Session-based learning</p>
            </div>

            <!-- Category Selection -->
            <div class="flex-1 flex flex-col justify-center">
                <div class="mb-6">
                    <h2 class="text-lg font-semibold text-center mb-3">Select Category</h2>
                    <div id="categorySelect" class="flex flex-wrap justify-center gap-2">
                        <!-- Rendered by JS -->
                    </div>
                </div>

                <!-- Question Type Selection -->
                <div class="mb-8">
                    <h2 class="text-lg font-semibold text-center mb-3">Question Type</h2>
                    <div id="typeSelect" class="flex flex-wrap justify-center gap-2">
                        <button data-type="mix"
                            class="filter-btn active bg-gray-700 text-gray-300 px-4 py-2 rounded-xl font-medium">Mix</button>
                        <button data-type="ingredients"
                            class="filter-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-xl font-medium">Ingredients</button>
                        <button data-type="glass"
                            class="filter-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-xl font-medium">Glass</button>
                        <button data-type="garnish"
                            class="filter-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-xl font-medium">Garnish</button>
                        <button data-type="ice"
                            class="filter-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-xl font-medium">Ice</button>
                        <button data-type="method"
                            class="filter-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-xl font-medium">Method</button>
                        <button data-type="qty"
                            class="filter-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-xl font-medium">Quantity</button>
                    </div>
                </div>
            </div>

            <!-- Start Button -->
            <div class="pb-6">
                <div id="sessionInfo" class="text-center text-gray-400 text-sm mb-3">
                    <!-- Shows how many questions will be in session -->
                </div>
                <button id="startSessionBtn"
                    class="btn-primary w-full text-white py-4 rounded-xl font-bold text-lg shadow-lg">
                    üöÄ Start Training
                </button>
            </div>
        </div>

        <!-- ============ TRAINING SCREEN ============ -->
        <div id="trainingScreen" class="screen p-4">
            <!-- Progress Header -->
            <div class="mb-4">
                <div class="flex justify-between items-center mb-2">
                    <button id="exitSessionBtn" class="text-gray-400 hover:text-white text-sm flex items-center gap-1">
                        ‚Üê Exit
                    </button>
                    <div id="progressText" class="text-sm font-medium text-gray-300">0/0</div>
                    <div class="flex gap-2">
                        <span
                            class="stat-badge bg-green-900/50 text-green-400 px-3 py-1 rounded-full text-sm font-semibold">
                            ‚úì <span id="statCorrect">0</span>
                        </span>
                        <span
                            class="stat-badge bg-red-900/50 text-red-400 px-3 py-1 rounded-full text-sm font-semibold">
                            ‚úó <span id="statWrong">0</span>
                        </span>
                    </div>
                </div>
                <div class="progress-container">
                    <div id="progressBar" class="progress-bar" style="width: 0%"></div>
                </div>
            </div>

            <!-- Question Card -->
            <div class="flex-1 flex items-center justify-center">
                <div id="trainerCard" class="question-card w-full p-6">
                    <div class="flex items-start justify-between gap-3 mb-4">
                        <div id="questionBlock" class="text-xl font-semibold flex-1"></div>
                        <button id="showInfoBtn"
                            class="info-btn flex-shrink-0 bg-gradient-to-br from-sky-500 to-sky-600 text-white w-10 h-10 rounded-full flex items-center justify-center shadow-lg"
                            title="Show cocktail info">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5"
                                stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z" />
                            </svg>
                        </button>
                    </div>

                    <button id="showAnswerBtn"
                        class="btn-primary w-full text-white py-4 rounded-xl font-semibold shadow-lg mb-4">
                        Show Answer
                    </button>

                    <div id="answerBlock" class="answer-reveal max-h-0 mb-4 text-center font-medium text-lg"></div>

                    <div id="selfCheckBlock" class="flex gap-3 hidden">
                        <button id="wrongBtn"
                            class="btn-danger flex-1 text-white py-4 rounded-xl font-semibold shadow-lg flex items-center justify-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5"
                                stroke="currentColor" class="w-6 h-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                            Wrong
                        </button>
                        <button id="correctBtn"
                            class="btn-success flex-1 text-white py-4 rounded-xl font-semibold shadow-lg flex items-center justify-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5"
                                stroke="currentColor" class="w-6 h-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
                            </svg>
                            Correct
                        </button>
                    </div>
                </div>
            </div>

            <!-- Swipe hint -->
            <div class="text-center text-gray-500 text-xs pb-2">
                ‚Üê Swipe left for Correct ‚Ä¢ Swipe right for Wrong ‚Üí
            </div>
        </div>

        <!-- ============ COMPLETE SCREEN ============ -->
        <div id="completeScreen" class="screen p-4">
            <div class="flex-1 flex flex-col items-center justify-center text-center">
                <div class="celebrate-emoji text-6xl mb-4">üéâ</div>
                <h2 class="text-3xl font-bold text-sky-400 mb-2">Session Complete!</h2>
                <p id="completeCategory" class="text-gray-400 mb-6"></p>

                <div class="bg-gray-800 rounded-2xl p-6 w-full max-w-xs mb-6">
                    <div class="grid grid-cols-2 gap-4 text-center">
                        <div>
                            <div class="text-4xl font-bold text-green-400" id="finalCorrect">0</div>
                            <div class="text-sm text-gray-400">Correct</div>
                        </div>
                        <div>
                            <div class="text-4xl font-bold text-red-400" id="finalWrong">0</div>
                            <div class="text-sm text-gray-400">Mistakes</div>
                        </div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-gray-700">
                        <div class="text-2xl font-bold text-sky-400" id="finalAccuracy">0%</div>
                        <div class="text-sm text-gray-400">Accuracy</div>
                    </div>
                </div>
            </div>

            <div class="pb-6 space-y-3">
                <button id="restartSessionBtn"
                    class="btn-primary w-full text-white py-4 rounded-xl font-bold text-lg shadow-lg">
                    üîÑ Train Again
                </button>
                <button id="changeCategoryBtn" class="w-full text-gray-400 py-3 rounded-xl font-medium">
                    Change Category
                </button>
            </div>
        </div>
    </div>

    <!-- ============ INFO MODAL ============ -->
    <div id="cocktailInfoModal" class="fixed inset-0 z-50 flex items-center justify-center modal-backdrop hidden">
        <div class="bg-gray-800 rounded-2xl shadow-xl max-w-md w-full mx-4 p-6 relative max-h-[80vh] overflow-y-auto">
            <button id="closeInfoBtn"
                class="absolute top-3 right-3 text-gray-400 hover:text-red-500 text-2xl p-1 rounded-full">‚úï</button>
            <div id="cocktailInfoContent"></div>
        </div>
    </div>

    <script>
        // ============ STATE ============
        let allCocktails = [];
        let allSpirits = [];

        // Session state
        let sessionQueue = [];       // Questions remaining
        let sessionCompleted = [];   // Answered correctly
        let sessionTotal = 0;        // Total at start
        let statCorrect = 0;
        let statWrong = 0;

        // Current question
        let currentQuestion = null;
        let selectedCategory = 'all';
        let selectedType = 'mix';

        // ============ DOM ELEMENTS ============
        const setupScreen = document.getElementById('setupScreen');
        const trainingScreen = document.getElementById('trainingScreen');
        const completeScreen = document.getElementById('completeScreen');

        const categorySelect = document.getElementById('categorySelect');
        const typeSelect = document.getElementById('typeSelect');
        const sessionInfo = document.getElementById('sessionInfo');
        const startSessionBtn = document.getElementById('startSessionBtn');

        const progressText = document.getElementById('progressText');
        const progressBar = document.getElementById('progressBar');
        const statCorrectEl = document.getElementById('statCorrect');
        const statWrongEl = document.getElementById('statWrong');
        const exitSessionBtn = document.getElementById('exitSessionBtn');

        const trainerCard = document.getElementById('trainerCard');
        const questionBlock = document.getElementById('questionBlock');
        const answerBlock = document.getElementById('answerBlock');
        const showAnswerBtn = document.getElementById('showAnswerBtn');
        const selfCheckBlock = document.getElementById('selfCheckBlock');
        const correctBtn = document.getElementById('correctBtn');
        const wrongBtn = document.getElementById('wrongBtn');
        const showInfoBtn = document.getElementById('showInfoBtn');

        const cocktailInfoModal = document.getElementById('cocktailInfoModal');
        const closeInfoBtn = document.getElementById('closeInfoBtn');
        const cocktailInfoContent = document.getElementById('cocktailInfoContent');

        const restartSessionBtn = document.getElementById('restartSessionBtn');
        const changeCategoryBtn = document.getElementById('changeCategoryBtn');

        // ============ SCREEN NAVIGATION ============
        function showScreen(screenId) {
            [setupScreen, trainingScreen, completeScreen].forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        // ============ SETUP SCREEN ============
        function renderCategoryButtons() {
            const categories = ['all', ...Array.from(new Set(allCocktails.map(c => c.category).filter(Boolean))).sort()];
            categorySelect.innerHTML = '';
            categories.forEach(cat => {
                const btn = document.createElement('button');
                btn.className = 'filter-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-xl font-medium';
                btn.textContent = cat.charAt(0).toUpperCase() + cat.slice(1);
                btn.dataset.category = cat;
                if (cat === selectedCategory) btn.classList.add('active');
                btn.onclick = () => {
                    categorySelect.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    selectedCategory = cat;
                    updateSessionInfo();
                };
                categorySelect.appendChild(btn);
            });
        }

        function setupTypeButtons() {
            typeSelect.querySelectorAll('.filter-btn').forEach(btn => {
                btn.onclick = () => {
                    typeSelect.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    selectedType = btn.dataset.type;
                };
            });
        }

        function updateSessionInfo() {
            const count = getFilteredCocktails().length;
            sessionInfo.textContent = `${count} questions in this session`;
        }

        function getFilteredCocktails() {
            if (selectedCategory === 'all') return allCocktails;
            return allCocktails.filter(c => c.category && c.category.toLowerCase() === selectedCategory.toLowerCase());
        }

        // ============ SESSION MANAGEMENT ============
        function startSession() {
            const cocktails = getFilteredCocktails();
            if (cocktails.length === 0) {
                alert('No cocktails in this category');
                return;
            }

            // Build and shuffle queue
            sessionQueue = shuffleArray([...cocktails]);
            sessionCompleted = [];
            sessionTotal = sessionQueue.length;
            statCorrect = 0;
            statWrong = 0;

            updateStats();
            showScreen('trainingScreen');
            nextQuestion();
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function endSession() {
            // Show complete screen
            document.getElementById('completeCategory').textContent =
                selectedCategory === 'all' ? 'All Categories' : selectedCategory.charAt(0).toUpperCase() + selectedCategory.slice(1);
            document.getElementById('finalCorrect').textContent = statCorrect;
            document.getElementById('finalWrong').textContent = statWrong;
            const accuracy = sessionTotal > 0 ? Math.round((statCorrect / sessionTotal) * 100) : 0;
            document.getElementById('finalAccuracy').textContent = accuracy + '%';
            showScreen('completeScreen');
        }

        // ============ QUESTION FLOW ============
        function nextQuestion() {
            // Reset UI
            answerBlock.innerHTML = '';
            answerBlock.style.maxHeight = '0';
            selfCheckBlock.classList.add('hidden');
            showAnswerBtn.disabled = false;
            showAnswerBtn.classList.remove('hidden');

            // Check if session complete
            if (sessionQueue.length === 0) {
                endSession();
                return;
            }

            // Get next cocktail from queue
            const cocktail = sessionQueue.shift();

            // Determine question type
            let type = selectedType;
            if (type === 'mix') {
                const types = ['ingredients', 'glass', 'garnish', 'ice', 'method'];
                type = types[Math.floor(Math.random() * types.length)];
            }

            currentQuestion = { cocktail, type };

            // Generate question text
            const name = `<span class="text-sky-400 font-bold">${cocktail.name}</span>`;
            if (type === 'ingredients') {
                questionBlock.innerHTML = `What are the ingredients in ${name}?`;
            } else if (type === 'glass') {
                questionBlock.innerHTML = `What glass for ${name}?`;
            } else if (type === 'garnish') {
                questionBlock.innerHTML = `What garnish for ${name}?`;
            } else if (type === 'ice') {
                questionBlock.innerHTML = `What ice for ${name}?`;
            } else if (type === 'method') {
                questionBlock.innerHTML = `What method for ${name}?`;
            } else if (type === 'qty') {
                if (!cocktail.ingredients || !cocktail.ingredients.length) {
                    sessionQueue.push(cocktail); // Re-add and try another
                    nextQuestion();
                    return;
                }
                const ing = cocktail.ingredients[Math.floor(Math.random() * cocktail.ingredients.length)];
                currentQuestion.ingredient = ing;
                questionBlock.innerHTML = `How much <span class="text-amber-400 font-bold">${ing.name}</span> in ${name}?`;
            }

            updateProgress();
        }

        function showAnswer() {
            if (!currentQuestion) return;

            let answerHtml = '';
            const { cocktail, type, ingredient } = currentQuestion;

            if (type === 'ingredients') {
                answerHtml = '<ul class="text-left mx-auto max-w-xs space-y-1">' +
                    cocktail.ingredients.map(ing =>
                        `<li>‚Ä¢ <span class="font-semibold">${ing.name}</span> <span class="text-gray-400 text-sm">(${ing.qty})</span></li>`
                    ).join('') + '</ul>';
            } else if (type === 'glass') {
                answerHtml = `<span class="text-2xl font-bold">${cocktail.glass || 'N/A'}</span>`;
            } else if (type === 'garnish') {
                answerHtml = `<span class="text-2xl font-bold">${cocktail.garnish || 'N/A'}</span>`;
            } else if (type === 'ice') {
                answerHtml = `<span class="text-2xl font-bold">${cocktail.ice || 'N/A'}</span>`;
            } else if (type === 'method') {
                answerHtml = `<span class="text-2xl font-bold">${cocktail.method || 'N/A'}</span>`;
            } else if (type === 'qty') {
                answerHtml = `<span class="text-2xl font-bold">${ingredient.qty}</span>`;
            }

            answerBlock.innerHTML = answerHtml;
            answerBlock.style.maxHeight = '400px';
            selfCheckBlock.classList.remove('hidden');
            showAnswerBtn.classList.add('hidden');
        }

        function handleCorrect() {
            statCorrect++;
            sessionCompleted.push(currentQuestion.cocktail);
            updateStats();
            animateCard('left', nextQuestion);
        }

        function handleWrong() {
            statWrong++;
            // Add back to end of queue for retry
            sessionQueue.push(currentQuestion.cocktail);
            updateStats();
            animateCard('right', nextQuestion);
        }

        function animateCard(direction, callback) {
            trainerCard.classList.add(direction === 'left' ? 'swipe-left' : 'swipe-right');
            setTimeout(() => {
                trainerCard.classList.remove('swipe-left', 'swipe-right');
                trainerCard.style.transform = '';
                callback();
            }, 250);
        }

        // ============ UI UPDATES ============
        function updateStats() {
            statCorrectEl.textContent = statCorrect;
            statWrongEl.textContent = statWrong;
        }

        function updateProgress() {
            const completed = sessionCompleted.length;
            const percent = sessionTotal > 0 ? Math.round((completed / sessionTotal) * 100) : 0;
            progressText.textContent = `${completed}/${sessionTotal}`;
            progressBar.style.width = percent + '%';
        }

        // ============ COCKTAIL INFO MODAL ============
        function showCocktailInfo() {
            if (!currentQuestion || !currentQuestion.cocktail) return;
            const c = currentQuestion.cocktail;
            cocktailInfoContent.innerHTML = `
                <h2 class="text-2xl font-bold text-sky-400 mb-4">${c.name}</h2>
                <div class="space-y-2 text-sm">
                    <div><span class="font-semibold text-gray-400">Category:</span> ${c.category || 'N/A'}</div>
                    <div><span class="font-semibold text-gray-400">Glass:</span> ${c.glass || 'N/A'}</div>
                    <div><span class="font-semibold text-gray-400">Ice:</span> ${c.ice || 'N/A'}</div>
                    <div><span class="font-semibold text-gray-400">Garnish:</span> ${c.garnish || 'N/A'}</div>
                    <div><span class="font-semibold text-gray-400">Method:</span> ${c.method || 'N/A'}</div>
                    <div class="mt-3">
                        <span class="font-semibold text-gray-400">Ingredients:</span>
                        <ul class="list-disc pl-5 mt-1 space-y-1">
                            ${(c.ingredients || []).map(ing =>
                `<li><span class="font-medium">${ing.name}</span> <span class="text-gray-500">(${ing.qty})</span></li>`
            ).join('')}
                        </ul>
                    </div>
                </div>
            `;
            cocktailInfoModal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            cocktailInfoModal.classList.add('hidden');
            document.body.style.overflow = '';
        }

        // ============ SWIPE SUPPORT ============
        let swipeStartX = null;

        trainerCard.addEventListener('touchstart', (e) => {
            if (e.touches.length === 1) {
                swipeStartX = e.touches[0].clientX;
            }
        });

        trainerCard.addEventListener('touchmove', (e) => {
            if (swipeStartX === null) return;
            const deltaX = e.touches[0].clientX - swipeStartX;
            trainerCard.style.transform = `translateX(${deltaX}px) rotate(${deltaX * 0.05}deg)`;
        });

        trainerCard.addEventListener('touchend', (e) => {
            if (swipeStartX === null) return;
            const deltaX = e.changedTouches[0].clientX - swipeStartX;
            trainerCard.style.transition = 'transform 0.3s';

            if (deltaX < -80) {
                // Swipe left = Correct
                handleCorrect();
            } else if (deltaX > 80) {
                // Swipe right = Wrong
                handleWrong();
            } else {
                // Reset
                trainerCard.style.transform = '';
            }

            setTimeout(() => {
                trainerCard.style.transition = '';
            }, 300);
            swipeStartX = null;
        });

        // ============ EVENT LISTENERS ============
        startSessionBtn.onclick = startSession;
        showAnswerBtn.onclick = showAnswer;
        correctBtn.onclick = handleCorrect;
        wrongBtn.onclick = handleWrong;
        showInfoBtn.onclick = showCocktailInfo;
        closeInfoBtn.onclick = closeModal;
        cocktailInfoModal.onclick = (e) => { if (e.target === cocktailInfoModal) closeModal(); };

        exitSessionBtn.onclick = () => {
            if (confirm('Exit training session?')) {
                showScreen('setupScreen');
            }
        };

        restartSessionBtn.onclick = startSession;
        changeCategoryBtn.onclick = () => showScreen('setupScreen');

        // ============ INITIALIZATION ============
        function initializeTrainer() {
            if (window.allCocktails && window.allCocktails.length > 0) {
                allCocktails = window.allCocktails;
                renderCategoryButtons();
                setupTypeButtons();
                updateSessionInfo();
            } else {
                sessionInfo.textContent = 'Loading data...';
            }
        }

        window.addEventListener('cocktailsLoaded', initializeTrainer);

        document.addEventListener('DOMContentLoaded', () => {
            if (window.cocktailsDataReady) {
                initializeTrainer();
            }
        });
        // Service Worker registration (for PWA)
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js')
                .then(reg => console.log('SW registered'))
                .catch(err => console.log('SW error:', err));
        }
    </script>
</body>

</html>